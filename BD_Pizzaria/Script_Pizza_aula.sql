-- Criando a tabela cliente
CREATE TABLE [CLIENTE]
(
    [COD_CLIENTE] INTEGER NOT NULL,
    [NOME] NVARCHAR(160)  NOT NULL,
    [TELEFONE] NVARCHAR(160)  NOT NULL,
    [ENDERECO] NVARCHAR(160)  NOT NULL,
    CONSTRAINT [PK_CLIENTE] PRIMARY KEY ([COD_CLIENTE])
);

-- Exemplo com AUTOINCREMENT
-- CREATE TABLE [CLIENTE]
-- (
-- [COD_CLIENTE] INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,
-- [NOME] NVARCHAR(160)  NOT NULL,
-- [TELEFONE] NVARCHAR(160)  NOT NULL,
-- [ENDERECO] NVARCHAR(160)  NOT NULL
-- );
-- INSERT INTO CLIENTE (NOME, TELEFONE, ENDERECO)
-- VALUES ('ARAMUNI', '98888-8888', 'Rua X');

CREATE UNIQUE INDEX [IPK_CLIENTE] ON [CLIENTE]([COD_CLIENTE]);

-- Criando a tabela forma pagamento
CREATE TABLE [FORMA_PAGAMENTO]
(
    [COD_FORMA_PAGAMENTO] INTEGER NOT NULL,
    [DES_FORMA_PAGAMENTO] NVARCHAR(160)  NOT NULL,
    CONSTRAINT [PK_FORMA_PAGAMENTO] PRIMARY KEY ([COD_FORMA_PAGAMENTO])
);

CREATE UNIQUE INDEX [IPK_FORMA_PAGAMENTO] ON [FORMA_PAGAMENTO]([COD_FORMA_PAGAMENTO]);

-- Criando a tabela fornecedor
CREATE TABLE [FORNECEDOR]
(
    [COD_FORNECEDOR] INTEGER NOT NULL,
    [NOME] NVARCHAR(160)  NOT NULL,
    [TELEFONE] NVARCHAR(160)  NOT NULL,
    [ENDERECO] NVARCHAR(160)  NOT NULL,
    CONSTRAINT [PK_FORNECEDOR] PRIMARY KEY ([COD_FORNECEDOR])
);

CREATE UNIQUE INDEX [IPK_FORNECEDOR] ON [FORNECEDOR]([COD_FORNECEDOR]);

-- Criando a tabela situacao_pedido
CREATE TABLE [SITUACAO_PEDIDO]
(
    [COD_SITUACAO_PEDIDO] INTEGER NOT NULL,
    [STATUS_PEDIDO] NVARCHAR(160)  NOT NULL,
    [STATUS_PAGAMENTO] NVARCHAR(160)  NOT NULL,
    CONSTRAINT [PK_SITUACAO_PEDIDO] PRIMARY KEY ([COD_SITUACAO_PEDIDO])
);

CREATE UNIQUE INDEX [IPK_SITUACAO_PEDIDO] ON [SITUACAO_PEDIDO]([COD_SITUACAO_PEDIDO]);

-- Criando a tabela vendedor
CREATE TABLE [VENDEDOR]
(
    [COD_VENDEDOR] INTEGER NOT NULL,
    [NOME] NVARCHAR(160)  NOT NULL,
    [TELEFONE] NVARCHAR(160)  NOT NULL,
    [ENDERECO] NVARCHAR(160)  NOT NULL,
    CONSTRAINT [PK_VENDEDOR] PRIMARY KEY ([COD_VENDEDOR])
);

CREATE UNIQUE INDEX [IPK_VENDEDOR] ON [VENDEDOR]([COD_VENDEDOR]);

-- Criando a tabela tipo_produto
CREATE TABLE [TIPO_PRODUTO]
(
    [COD_TIPO_PRODUTO] INTEGER NOT NULL,
    [DES_TIPO_PRODUTO] NVARCHAR(160)  NOT NULL,
    CONSTRAINT [PK_TIPO_PRODUTO] PRIMARY KEY ([COD_TIPO_PRODUTO])
);

CREATE UNIQUE INDEX [IPK_TIPO_PRODUTO] ON [TIPO_PRODUTO]([COD_TIPO_PRODUTO]);

-- Criando a tabela produto
CREATE TABLE [PRODUTO]
(
	[COD_PRODUTO] INTEGER NOT NULL,
	[COD_TIPO_PRODUTO] INTEGER NOT NULL,
	[NOME] NVARCHAR(160)  NOT NULL,
	[VLR_PRODUTO_COMPRA] FLOAT(8,2)  NOT NULL,
	[VLR_PRODUTO_VENDA] FLOAT(8,2)  NOT NULL,
	CONSTRAINT [PK_PRODUTO] PRIMARY KEY ([COD_PRODUTO]),
	CONSTRAINT [FK_TIPO_PRODUTO] FOREIGN KEY ([COD_TIPO_PRODUTO]) REFERENCES TIPO_PRODUTO(COD_TIPO_PRODUTO)
);

CREATE UNIQUE INDEX [IPK_PRODUTO] ON [PRODUTO]([COD_PRODUTO]);

-- Criando a tabela pedido_compra
CREATE TABLE [PEDIDO_COMPRA]
(
    [COD_PEDIDO_COMPRA] INTEGER NOT NULL,
    [COD_FORNECEDOR] INTEGER NOT NULL,
    [VLR_PEDIDO_COMPRA] FLOAT(8,2)  NOT NULL,
    CONSTRAINT [PK_PEDIDO_COMPRA] PRIMARY KEY ([COD_PEDIDO_COMPRA]),
    CONSTRAINT [FK_FORNECEDOR] FOREIGN KEY ([COD_FORNECEDOR]) REFERENCES FORNECEDOR(COD_FORNECEDOR)
);

CREATE UNIQUE INDEX [IPK_PEDIDO_COMPRA] ON [PEDIDO_COMPRA]([COD_PEDIDO_COMPRA]);

-- Criando a tabela item_pedido_compra
CREATE TABLE [ITEM_PEDIDO_COMPRA]
(
    [COD_ITEM_PEDIDO_COMPRA] INTEGER NOT NULL,
    [COD_PEDIDO_COMPRA] INTEGER NOT NULL,
    [COD_PRODUTO] INTEGER NOT NULL,
    [QTD_ITEM_PEDIDO_COMPRA] INTEGER NOT NULL,
    CONSTRAINT [PK_ITEM_PEDIDO_COMPRA] PRIMARY KEY ([COD_ITEM_PEDIDO_COMPRA]),
    CONSTRAINT [FK_PEDIDO_COMPRA] FOREIGN KEY ([COD_PEDIDO_COMPRA]) REFERENCES PEDIDO_COMPRA(COD_PEDIDO_COMPRA),
	CONSTRAINT [FK_PRODUTO] FOREIGN KEY ([COD_PRODUTO]) REFERENCES PRODUTO(COD_PRODUTO)
);

CREATE UNIQUE INDEX [IPK_ITEM_PEDIDO_COMPRA] ON [ITEM_PEDIDO_COMPRA]([COD_ITEM_PEDIDO_COMPRA]);

-- Criando a tabela pedido_venda
CREATE TABLE [PEDIDO_VENDA]
(
    [COD_PEDIDO_VENDA] INTEGER NOT NULL,
    [COD_CLIENTE] INTEGER NOT NULL,
    [COD_VENDEDOR] INTEGER NOT NULL,
    [COD_SITUACAO_PEDIDO] INTEGER NOT NULL,
    [COD_FORMA_PAGAMENTO] INTEGER NOT NULL,
    [DATA_PEDIDO] DATETIME NOT NULL,
    [VLR_PEDIDO_VENDA] FLOAT(8,2)  NOT NULL,
    CONSTRAINT [PK_PEDIDO_VENDA] PRIMARY KEY ([COD_PEDIDO_VENDA]),
    CONSTRAINT [FK_CLIENTE] FOREIGN KEY ([COD_CLIENTE]) REFERENCES CLIENTE(COD_CLIENTE),
	CONSTRAINT [FK_VENDEDOR] FOREIGN KEY ([COD_VENDEDOR]) REFERENCES VENDEDOR(COD_VENDEDOR),
	CONSTRAINT [FK_SITUACAO_PEDIDO] FOREIGN KEY ([COD_SITUACAO_PEDIDO]) REFERENCES SITUACAO_PEDIDO(COD_SITUACAO_PEDIDO),
    CONSTRAINT [FK_FORMA_PAGAMENTO] FOREIGN KEY ([COD_FORMA_PAGAMENTO]) REFERENCES FORMA_PAGAMENTO(COD_FORMA_PAGAMENTO)
);

CREATE UNIQUE INDEX [IPK_PEDIDO_VENDA] ON [PEDIDO_VENDA]([COD_PEDIDO_VENDA]);

-- Criando a tabela item_pedido_venda
CREATE TABLE [ITEM_PEDIDO_VENDA]
(
    [COD_ITEM_PEDIDO_VENDA] INTEGER NOT NULL,
    [COD_PEDIDO_VENDA] INTEGER NOT NULL,
    [COD_PRODUTO] INTEGER NOT NULL,
    [QTD_ITEM_PEDIDO_VENDA] INTEGER NOT NULL,
    CONSTRAINT [PK_ITEM_PEDIDO_VENDA] PRIMARY KEY ([COD_ITEM_PEDIDO_VENDA]),
    CONSTRAINT [FK_PEDIDO_VENDA] FOREIGN KEY ([COD_PEDIDO_VENDA]) REFERENCES PEDIDO_COMPRA(COD_PEDIDO_COMPRA),
	CONSTRAINT [FK_PRODUTO] FOREIGN KEY ([COD_PRODUTO]) REFERENCES PRODUTO(COD_PRODUTO)
);

CREATE UNIQUE INDEX [IPK_ITEM_PEDIDO_VENDA] ON [ITEM_PEDIDO_VENDA]([COD_ITEM_PEDIDO_VENDA]);

-- Criando a tabela cotacao
CREATE TABLE [COTACAO]
(
    [COD_COTACAO] INTEGER NOT NULL,
    [COD_PRODUTO] INTEGER NOT NULL,
    [COD_FORNECEDOR] INTEGER NOT NULL,
    [VLR_COTACAO] FLOAT(8,2) NOT NULL,
    [UNIDADE_MEDIDA] NVARCHAR(160) NOT NULL,
    CONSTRAINT [PK_COTACAO] PRIMARY KEY ([COD_COTACAO]),
    CONSTRAINT [FK_PRODUTO] FOREIGN KEY ([COD_PRODUTO]) REFERENCES PRODUTO(COD_PRODUTO),
	CONSTRAINT [FK_FORNECEDOR] FOREIGN KEY ([COD_FORNECEDOR]) REFERENCES FORNECEDOR(COD_FORNECEDOR)
);

CREATE UNIQUE INDEX [IPK_COTACAO] ON [COTACAO]([COD_COTACAO]);

-- INSERT [Exemplo de INSERT na Tabela CLIENTE]
INSERT INTO CLIENTE (COD_CLIENTE, NOME, TELEFONE, ENDERECO) VALUES (1, 'Aramuni', '98888-8888', 'Rua X');
INSERT INTO CLIENTE (COD_CLIENTE, NOME, TELEFONE, ENDERECO) VALUES (2, 'Tiago João', '99088-8118', 'Rua Quebrada');
INSERT INTO CLIENTE (COD_CLIENTE, NOME, TELEFONE, ENDERECO) VALUES (3, 'Maria Clara', '98000-8888', 'Rua Saude');
INSERT INTO CLIENTE (COD_CLIENTE, NOME, TELEFONE, ENDERECO) VALUES (4, 'Wanderley Silva', '98888-8110', 'Rua Y');
INSERT INTO CLIENTE (COD_CLIENTE, NOME, TELEFONE, ENDERECO) VALUES (5, 'Carlos Henrique', '99850-8008', 'Rua Agua');

-- SELECT [Exemplo de SELECT na Tabela CLIENTE]
SELECT * FROM CLIENTE;

-- UPDATE [Exemplo de UPDATE na Tabela CLIENTE]
UPDATE CLIENTE SET NOME = 'João Aramuni' WHERE COD_CLIENTE = 1;

-- DELETE [Exemplo de DELETE na Tabela CLIENTE]
DELETE FROM CLIENTE WHERE COD_CLIENTE = 1;

-- INSERT [Exemplo de INSERT na Tabela TIPO_PRODUTO]
INSERT INTO TIPO_PRODUTO (COD_TIPO_PRODUTO, DES_TIPO_PRODUTO) VALUES (1, 'Bebida');
INSERT INTO TIPO_PRODUTO (COD_TIPO_PRODUTO, DES_TIPO_PRODUTO) VALUES (2, 'Comida');
INSERT INTO TIPO_PRODUTO (COD_TIPO_PRODUTO, DES_TIPO_PRODUTO) VALUES (3, 'Doce');

-- INSERT [Exemplo de INSERT na Tabela FORMA_PAGAMENTO]
INSERT INTO FORMA_PAGAMENTO (COD_FORMA_PAGAMENTO, DES_FORMA_PAGAMENTO) VALUES (1, 'Crédito');
INSERT INTO FORMA_PAGAMENTO (COD_FORMA_PAGAMENTO, DES_FORMA_PAGAMENTO) VALUES (2, 'PIX');
INSERT INTO FORMA_PAGAMENTO (COD_FORMA_PAGAMENTO, DES_FORMA_PAGAMENTO) VALUES (3, 'Dinheiro');

-- INSERT [Exemplo de INSERT na Tabela SITUACAO_PEDIDO]
INSERT INTO SITUACAO_PEDIDO (COD_SITUACAO_PEDIDO, STATUS_PEDIDO, STATUS_PAGAMENTO) VALUES (1, 'ENTREGUE', 'PAGO');
INSERT INTO SITUACAO_PEDIDO (COD_SITUACAO_PEDIDO, STATUS_PEDIDO, STATUS_PAGAMENTO) VALUES (2, 'A CAMINHO', 'PAGO');
INSERT INTO SITUACAO_PEDIDO (COD_SITUACAO_PEDIDO, STATUS_PEDIDO, STATUS_PAGAMENTO) VALUES (3, 'PREPARANDO', 'PAGO');
INSERT INTO SITUACAO_PEDIDO (COD_SITUACAO_PEDIDO, STATUS_PEDIDO, STATUS_PAGAMENTO) VALUES (4, 'AGUARDANDO', 'PENDENTE');

-- INSERT [Exemplo de INSERT na Tabela Vendedor]
INSERT INTO VENDEDOR (COD_VENDEDOR, NOME,TELEFONE, ENDERECO) VALUES (1,'Jefferson', '31 98885-0022', 'Rua Amora, 5005');
INSERT INTO VENDEDOR (COD_VENDEDOR, NOME, TELEFONE, ENDERECO) VALUES (2,'Julia Alfa', '31 9225-1122', 'Rua Flor, 515');
INSERT INTO VENDEDOR (COD_VENDEDOR, NOME, TELEFONE, ENDERECO) VALUES (3,'Juliana', '31 98115-2221', 'Rua Cai Cai, 5');
INSERT INTO VENDEDOR (COD_VENDEDOR, NOME, TELEFONE, ENDERECO) VALUES (4,'Maria Ana', '31 99005-2122', 'Rua Altro, 15');

-- INSERT [Exemplo de INSERT na Tabela Item Pedido Venda]
INSERT INTO ITEM_PEDIDO_VENDA (COD_ITEM_PEDIDO_VENDA, COD_PEDIDO_VENDA, COD_PRODUTO, QTD_ITEM_PEDIDO_VENDA) VALUES (1, 1, 1, 15);
INSERT INTO ITEM_PEDIDO_VENDA (COD_ITEM_PEDIDO_VENDA, COD_PEDIDO_VENDA, COD_PRODUTO, QTD_ITEM_PEDIDO_VENDA) VALUES (2, 1, 7, 02);
INSERT INTO ITEM_PEDIDO_VENDA (COD_ITEM_PEDIDO_VENDA, COD_PEDIDO_VENDA, COD_PRODUTO, QTD_ITEM_PEDIDO_VENDA) VALUES (3, 1, 2, 10);
INSERT INTO ITEM_PEDIDO_VENDA (COD_ITEM_PEDIDO_VENDA, COD_PEDIDO_VENDA, COD_PRODUTO, QTD_ITEM_PEDIDO_VENDA) VALUES (4, 1, 3, 15);
INSERT INTO ITEM_PEDIDO_VENDA (COD_ITEM_PEDIDO_VENDA, COD_PEDIDO_VENDA, COD_PRODUTO, QTD_ITEM_PEDIDO_VENDA) VALUES (5, 1, 4, 1);
INSERT INTO ITEM_PEDIDO_VENDA (COD_ITEM_PEDIDO_VENDA, COD_PEDIDO_VENDA, COD_PRODUTO, QTD_ITEM_PEDIDO_VENDA) VALUES (6, 1, 2, 9);

-- INSERT [Exemplo de INSERT na Tabela Item Pedido Venda]
INSERT INTO PEDIDO_VENDA (COD_PEDIDO_VENDA, COD_CLIENTE, COD_VENDEDOR, COD_SITUACAO_PEDIDO, COD_FORMA_PAGAMENTO, DATA_PEDIDO, VLR_PEDIDO_VENDA )
VALUES (1, 1, 1, 2, 1, '2023-02-01 12:20:00', 15.20);
INSERT INTO PEDIDO_VENDA (COD_PEDIDO_VENDA, COD_CLIENTE, COD_VENDEDOR, COD_SITUACAO_PEDIDO, COD_FORMA_PAGAMENTO, DATA_PEDIDO, VLR_PEDIDO_VENDA )
VALUES (2, 2, 2, 2, 1, '2023-01-01 12:25:00', 12.90);	
INSERT INTO PEDIDO_VENDA (COD_PEDIDO_VENDA, COD_CLIENTE, COD_VENDEDOR, COD_SITUACAO_PEDIDO, COD_FORMA_PAGAMENTO, DATA_PEDIDO, VLR_PEDIDO_VENDA )
VALUES (3, 2, 2, 2, 1, '2023-02-01 19:50:00', 11.80);
INSERT INTO PEDIDO_VENDA (COD_PEDIDO_VENDA, COD_CLIENTE, COD_VENDEDOR, COD_SITUACAO_PEDIDO, COD_FORMA_PAGAMENTO, DATA_PEDIDO, VLR_PEDIDO_VENDA )
VALUES (4, 3, 3, 3, 3, '2023-08-11 18:30:00', 09.80);	

-- SELECT [Exemplo de SELECT na Tabela PEDIDO_VENDA]
SELECT * FROM PEDIDO_VENDA pv;

-- SELECT [Exemplo de SELECT na Tabela ITEM_PEDIDO_VENDA]
SELECT * FROM ITEM_PEDIDO_VENDA IPV;

-- SELECT [Exemplo de SELECT na Tabela PRODUTO]
SELECT * FROM PRODUTO P;

-- SELECT [Exemplo de SELECT na Tabela SITUACAO_PEDIDO]
SELECT * FROM SITUACAO_PEDIDO SP;

-- INSERT [Exemplo de INSERT na Tabela PRODUTO]
INSERT INTO PRODUTO (COD_PRODUTO, COD_TIPO_PRODUTO, NOME, VLR_PRODUTO_COMPRA, VLR_PRODUTO_VENDA) VALUES (1, 1, 'Skol', 8.00, 16.00);
INSERT INTO PRODUTO (COD_PRODUTO, COD_TIPO_PRODUTO, NOME, VLR_PRODUTO_COMPRA, VLR_PRODUTO_VENDA) VALUES (2, 1, 'Heineken', 4.00, 11.00);
INSERT INTO PRODUTO (COD_PRODUTO, COD_TIPO_PRODUTO, NOME, VLR_PRODUTO_COMPRA, VLR_PRODUTO_VENDA) VALUES (3, 1, 'Coca-Cola', 4.00, 12.50);
INSERT INTO PRODUTO (COD_PRODUTO, COD_TIPO_PRODUTO, NOME, VLR_PRODUTO_COMPRA, VLR_PRODUTO_VENDA) VALUES (4, 1, 'Água Mineral', 1.50, 5.00);
INSERT INTO PRODUTO (COD_PRODUTO, COD_TIPO_PRODUTO, NOME, VLR_PRODUTO_COMPRA, VLR_PRODUTO_VENDA) VALUES (5, 2, 'Ruffles', 1.50, 4.50);
INSERT INTO PRODUTO (COD_PRODUTO, COD_TIPO_PRODUTO, NOME, VLR_PRODUTO_COMPRA, VLR_PRODUTO_VENDA) VALUES (6, 2, 'Pimentinha', 1.70, 2.50);
INSERT INTO PRODUTO (COD_PRODUTO, COD_TIPO_PRODUTO, NOME, VLR_PRODUTO_COMPRA, VLR_PRODUTO_VENDA) VALUES (7, 3, 'Cocada', 0.50, 1.50);
INSERT INTO PRODUTO (COD_PRODUTO, COD_TIPO_PRODUTO, NOME, VLR_PRODUTO_COMPRA, VLR_PRODUTO_VENDA) VALUES (8, 3, 'Brigadeiro', 0.50, 1.50);


SELECT PV.DATA_PEDIDO, 	PV.VLR_PEDIDO_VENDA, C.NOME AS NOME_CLIENTE, V.NOME AS NOME_VENDEDOR, FP.DES_FORMA_PAGAMENTO, P.NOME AS NOME_PRODUTO, TP.DES_TIPO_PRODUTO
FROM PEDIDO_VENDA pv
INNER JOIN CLIENTE c ON C.COD_CLIENTE = PV.COD_CLIENTE 
INNER JOIN VENDEDOR v ON V.COD_VENDEDOR = PV.COD_VENDEDOR 
INNER JOIN FORMA_PAGAMENTO fp ON FP.COD_FORMA_PAGAMENTO = PV.COD_FORMA_PAGAMENTO 
INNER JOIN ITEM_PEDIDO_VENDA ipv ON IPV.COD_PEDIDO_VENDA = PV.COD_PEDIDO_VENDA 
INNER JOIN PRODUTO p ON P.COD_PRODUTO = IPV.COD_PRODUTO 
INNER JOIN TIPO_PRODUTO tp ON TP.COD_TIPO_PRODUTO = P.COD_TIPO_PRODUTO;

